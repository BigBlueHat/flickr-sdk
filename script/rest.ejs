var createClient = require('../request');
var validate = require('../validate');

/**
 * @constructor
 * @param {Function} auth
 */

function Flickr(auth) {

	// allow creating a client without `new`
	if (!(this instanceof Flickr)) {
		return new Flickr(auth);
	}

	// create a new client and assign it to all of our namespaces
	<%_ namespaces.forEach(function (ns) { _%>
	this.<%= ns %>._ =
	<%_ }); _%>
	createClient(auth);
}

<% namespaces.forEach(function (ns) { %>
/**
 * @namespace flickr.<%= ns %>
 */

Flickr.prototype.<%= ns %> = {};
<% getMethodsByNamespace(ns).forEach(function (method) { %>
/**
 * <%= method %>
 * @see https://www.flickr.com/services/api/<%= method %>.html
 */

Flickr.prototype.<%= ns %>.<%= basename(method) %> = function (args) {
	<%_ getRequiredArguments(method).forEach(function (arg) { _%>
	validate(args, '<%= arg %>');
	<%_ }); _%>
	return this._('<%= getHTTPVerb(method) %>', '<%= method %>', args);
};
<%_ }); _%>
<% }); %>
/**
 * @exports
 */

module.exports = Flickr;
